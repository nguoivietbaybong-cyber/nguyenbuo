<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Private Bot Online</title>
    <style>
        body { background: #000; color: #00ff00; font-family: monospace; display: flex; justify-content: center; padding: 20px; margin: 0; }
        .box { border: 2px solid #00ff00; padding: 20px; width: 100%; max-width: 350px; background: #050505; box-shadow: 0 0 15px rgba(0,255,0,0.3); }
        .row { display: flex; justify-content: space-between; margin: 10px 0; font-size: 1.1rem; }
        .big { font-size: 3rem; text-align: center; border: 1px dashed #00ff00; margin: 20px 0; font-weight: bold; padding: 10px; }
        .tai { color: #ff4d4d; border-color: #ff4d4d; } 
        .xiu { color: #4d94ff; border-color: #4d94ff; }
        .log { font-size: 12px; height: 150px; overflow-y: auto; border-top: 1px solid #333; margin-top: 15px; padding-top: 10px; color: #aaa; }
    </style>
</head>
<body>
    <div class="box">
        <div style="text-align:center; font-weight:bold; color:#00ff00;">[ HỆ THỐNG THEO DÕI ONLINE ]</div>
        <hr color="#333">
        <div class="row">Phiên: <span id="p" style="color:#fff">--</span></div>
        <div class="row">Xúc xắc: <span id="xx" style="color:#fff">?-?-?</span></div>
        <div class="row">Tổng: <span id="t" style="color:#fff">--</span></div>
        <div id="rs" class="big">ĐỢI...</div>
        <div id="logs" class="log"></div>
    </div>

    <script>
        // URL DATABASE CỦA BẠN
        const dbUrl = "https://app-tai-xiu-default-rtdb.firebaseio.com/taixiu_sessions/current.json";
        let lastP = null;

        async function update() {
            try {
                const res = await fetch(dbUrl);
                const data = await res.json();
                
                if (data && data.Phien !== lastP) {
                    // CẬP NHẬT GIAO DIỆN (SỬA LỖI UNDEFINED BẰNG CÁCH VIẾT HOA CHỮ ĐẦU)
                    document.getElementById('p').innerText = "#" + data.Phien;
                    document.getElementById('xx').innerText = data.Xuc_xac_1 + "-" + data.Xuc_xac_2 + "-" + data.Xuc_xac_3;
                    document.getElementById('t').innerText = data.Tong;
                    
                    const rs = document.getElementById('rs');
                    rs.innerText = data.Ket_qua;
                    rs.className = 'big ' + (data.Ket_qua === "Tài" ? "tai" : "xiu");

                    // Ghi lịch sử
                    const time = data.Thoi_gian ? data.Thoi_gian.split(' ')[1] : "";
                    const logHTML = `<div>[${time}] #${data.Phien}: <b>${data.Ket_qua}</b> (${data.Tong})</div>`;
                    document.getElementById('logs').insertAdjacentHTML('afterbegin', logHTML);
                    
                    lastP = data.Phien;
                }
            } catch (e) { 
                console.log("Đang chờ dữ liệu mới..."); 
            }
        }

        // Kiểm tra dữ liệu mỗi 2 giây
        setInterval(update, 2000);
        update();
    </script>
</body>
</html>
